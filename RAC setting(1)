# RAC (1) - install Linux, create ASM (IPì„¤ì •, Disks)

ë‚˜ëŠ” 28,29ë²ˆ ê°€ì ¸ê°

## **Oracle Real Application Clusters 19c Technical Architecture**

![2025-06-26 09 54 11.png](images/Export-f54ab508-0199-4520-8ef9-3ca01d87ff20/2025-06-26_09_54_11.png)

![2025-06-26 10 07 55.png](Export-f54ab508-0199-4520-8ef9-3ca01d87ff20)

![ë­‰íƒœê¸°](Export-f54ab508-0199-4520-8ef9-3ca01d87ff20)

ë­‰íƒœê¸°

![2025-06-26 10 21 35.png](2025-06-26_10_21_35.png)

- ë˜ ë‹¤ë¥¸ ë©”ëª¨ë¦¬ ì˜ì—­ì— ì¡´ì¬í•œë‹¤, ë„¤íŠ¸ì›Œí¬ë¡œ ì—°ê²°ë¨ (ì„œë²„ë“¤)
- ì†Œí”„íŠ¸ì›¨ì–´ë“¤ë¼ë¦¬ëŠ” ë”°ë¡œ ì‘ë™
- ì „ë¶€ ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•´ ì´ì–´ì ¸ìˆëŠ” ì„œë²„ì™€ ì €ì¥ê³µê°„ ë“±ë“±
- ê²Œì´íŠ¸ì›¨ì´í•„ìš”ì—†ìŒ, IP ë‘ ê°œ ìˆìŒ ëœë‹¤
- ë¹ ë¥¸ì†ë„ì˜ ì‘ì—…ë“¤ì„ ì²˜ë¦¬í•œë‹¤
- ì™¸ë¶€ì—ì„œ ì´ ì„œë²„ë¥¼ ì¸ì‹í•  ìˆ˜ ìˆëŠ” IPí•„ìš”
- ë‚´ì¥ LANí•„ìš”
- DNSì„œë²„í˜•ì‹ì„ ë¹Œë ¤ì„œ ìŠ¤ìº”(ì¼ë°˜ì ìœ¼ë¡œ ì¸ì‹í•  ìˆ˜ ìˆëŠ” ì„œë²„)
- shared storageëŠ” ê³µìœ í•˜ëŠ” ë°ì´í„°, ë¦¬ë‘ë¡œë“œ, ì»¨íŠ¸ë¡¤íŒŒì¼, ì•„ì¹´ì´ë¸ŒíŒŒì¼ë“¤ì„ ë”°ë¡œ ê´€ë¦¬í•˜ëŠ” ì˜ì—­ì´ë‹¤
    - OSê°€ ê°ë‹¹í•  ìˆ˜ ì—†ì–´ì„œ ìŠ¤í† ë¦¬ì§€ë¥¼ ë”°ë¡œ ê´€ë¦¬í•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ì„¤ì¹˜í•˜ëŠ” ê²½ìš°ìˆìŒ
    - ì´ì œëŠ” ASMì´ ë§ì´ ì•ˆì •í™”ë˜ì—ˆë‹¤
- ë©”ëª¨ë¦¬ì—ì„œ ë©”ëª¨ë¦¬ë¡œ ë°ì´í„°ë¥¼ ë„˜ê¸´ë‹¤
- RACë•Œë¬¸ì— ì˜¤ë¼í´ ì“°ëŠ” íšŒì‚¬ë“¤ ìˆìŒ
- RACë¥¼ í™œìš©í•˜ëŠ” ì´ìœ  : DBëŠ” í•­ìƒ ì˜¤í”ˆë˜ì–´ ìˆì–´ì•¼í•˜ê¸° ë•Œë¬¸ì—( HAìš”ì²­ë•Œë¬¸ì—)

## ì˜¤ë¼í´ 19c RAC ì„¤ì¹˜(VM í•„ìš” ì„¤ì • í¬í•¨) 1, 2ë²ˆê¹Œì§€

<aside>
â•

1. install Linux :í˜„ì¬ oel7.9, DISKí• ë‹¹, ë„¤íŠ¸ì›Œí¬ ì„¸íŒ… ë“±ë“±
2. create ASM : ì•ì„œ ë§Œë“  DISKì´ìš©í•´ì„œ ì„¸íŒ…
    
    -ì´ ì‹œì ì— ì„œë²„ ë³µì‚¬-
    
    ---
    
3. install grid :í˜„ì¬ 19.3, 
4. install DB S/W + create DB
</aside>

### 1. install Linux :í˜„ì¬ oel7.9, DISKí• ë‹¹, ë„¤íŠ¸ì›Œí¬ ì„¸íŒ… ë“±ë“±

1. VMwareì„¸íŒ…
    
    ![2025-06-26 11 41 32.png](2025-06-26_11_41_32.png)
    
    ![2025-06-26 11 41 09.png](2025-06-26_11_41_09.png)
    
    ![2025-06-26 11 43 15.png](2025-06-26_11_43_15.png)
    
    ![2025-06-26 11 42 30.png](2025-06-26_11_42_30.png)
    
    ![2025-06-26 11 42 53.png](2025-06-26_11_42_53.png)
    
    ![2025-06-26 11 46 07.png](2025-06-26_11_46_07.png)
    
    ![2025-06-26 12 00 54.png](2025-06-26_12_00_54.png)
    
    ![2025-06-26 12 00 42.png](2025-06-26_12_00_42.png)
    
    ![2025-06-26 12 00 32.png](2025-06-26_12_00_32.png)
    
    ![2025-06-26 11 50 00.png](2025-06-26_11_50_00.png)
    
    ![2025-06-26 12 15 34.png](2025-06-26_12_15_34.png)
    
2. ì˜¤ë¼í´ 19c RAC ì„¤ì¹˜ ì‹œì‘

```sql
yum install oracle-database-preinstall-19c â‡’ í•„ìš”í•œ RPMíŒ¨í‚¤ì§€ë“¤ì„ ì°¾ì•„ì¤€ë‹¤
```

![ì—ëŸ¬ë°œìƒí™”ë©´](2025-06-26_13_06_38.png)

ì—ëŸ¬ë°œìƒí™”ë©´

ğŸš¨ ì—ëŸ¬ê°€ ë‚˜ëŠ” ê²½ìš° ğŸš¨

```sql
ps -ef|grep yum <<-- yum í”„ë¡œì„¸ì„œ kill
```

```sql
rm -rf /var/run/yum.pid <<-- íŒŒì¼ ì œê±°
```

![yë‘ë²ˆ](2025-06-26_13_07_11.png)

yë‘ë²ˆ

```sql
 - Root:
  [root@oel7rac1 ~]# cat /etc/group
  [root@oel7rac1 ~]# groupadd dba     <<-- ì´ë¯¸ ìƒì„±
  
  [root@oel7rac1 ~]# cat /etc/passwd

  [root@oel7rac1 ~]# useradd -s /bin/bash -g dba grid
  [root@oel7rac1 ~]# usermod -g dba oracle
  [root@oel7rac1 ~]# groupdel oracle

  [root@oel7rac1 ~]# passwd grid
  [root@oel7rac1 ~]# mkdir -p /home/STAGE
  [root@oel7rac1 ~]# chmod 777 /home/STAGE/
```

![#cd /home/grid/.bash_profileì— umask022ì¶”ê°€](2025-06-26_13_14_33.png)

#cd /home/grid/.bash_profileì— umask022ì¶”ê°€

![# cd /home/oracle/.bash_profile ì— umask 022 ì¶”ê°€](2025-06-26_13_14_45.png)

# cd /home/oracle/.bash_profile ì— umask 022 ì¶”ê°€

![gridì— í•„ìš”ê¶Œí•œ ì„¤ì •](2025-06-26_13_14_56.png)

gridì— í•„ìš”ê¶Œí•œ ì„¤ì •

![gridì— í•„ìš” ë””ë ‰í† ë¦¬ ì„¤ì •](2025-06-26_13_17_19.png)

gridì— í•„ìš” ë””ë ‰í† ë¦¬ ì„¤ì •

![oracleì— í•„ìš” ë””ë ‰í† ë¦¬ ì„¤ì •](2025-06-26_13_17_27.png)

oracleì— í•„ìš” ë””ë ‰í† ë¦¬ ì„¤ì •

```sql
- Root
[root@oel7rac1 ~]# mkdir -p /u01/app/oracle/19.3.0/grid
[root@oel7rac1 ~]# mkdir -p /u01/app/grid
[root@oel7rac1 ~]# chown -R grid:dba /u01
[root@oel7rac1 ~]# chmod -R 775 /u01
=> ì—¬ê¸°ê¹Œì§€ ê·¸ë¦¬ë“œ
[root@oel7rac1 ~]# mkdir -p /u02/app/oracle
[root@oel7rac1 ~]# mkdir -p /u02/app/oraInventory
[root@oel7rac1 ~]# chown -R oracle:dba /u02/app/oracle
[root@oel7rac1 ~]# chown -R oracle:dba /u02/app/oraInventory
[root@oel7rac1 ~]# chmod -R 775 /u02/app
= >ê³µìœ í´ë” shared ì—°ê²° (vm ì„¸íŒ… -> ì˜µì…˜ )
```

![2025-06-26 15 38 47.png](2025-06-26_15_38_47.png)

![2025-06-26 14 40 29.png](2025-06-26_14_40_29.png)

```sql
[root@oel7rac1 ~]# ip addr
[root@oel7rac1 ~]# vi /etc/hosts
```

![[root@oel7rac1 ~]# vi /etc/hosts](2025-06-26_14_49_28.png)

[root@oel7rac1 ~]# vi /etc/hosts

### Public â‡’ ì™¸ë¶€ì—ì„œ ë“¤ì–´ì˜¬ ë•Œ ì°¾ì•„ ì˜¬ IP

192.168.101.28 oel7rac1  â‡’ ë‚˜ëŠ” ëìë¦¬ 28,29ë²ˆ ì‚¬ìš©
192.168.101.29 oel7rac2

### Private â‡’ ê²Œì´íŠ¸ì›¨ì´ ì—†ì´ ë’¤ì•¼í•¨, ë‚˜ê°€ì§€ ì•ŠëŠ”ë‹¤

192.168.56.128 oel7rac1-priv
192.168.56.129 oel7rac2-priv

### Virtual â‡’ publicë³´ë‹¤ ë§ì´ ì“°ê¸°ë„ í•¨

192.168.101.20 oel7rac1-vip â‡’ ëìë¦¬ 20,21ì‚¬ìš©
192.168.101.21 oel7rac2-vip

### Scan â‡’ 3ê°œ ì‚¬ìš©ì„ ì˜¤ë¼í´ì—ì„  ê¶Œì¥í•˜ê¸´í•¨, ë°”ê¹¥ì—ì„œ íƒ€ê³  ë“¤ì–´ ì˜¬ ë•Œ ê¸¸ ì°¾ì•„ì¤Œ

192.168.101.72 oel7rac-scan

![í˜¸ìŠ¤íŠ¸ë„¤ì„ í™•ì¸](2025-06-26_14_59_20.png)

í˜¸ìŠ¤íŠ¸ë„¤ì„ í™•ì¸

```sql
[root@oel7rac1 ~]# hostnamectl  set-hostname  oel7rac1
[root@oel7rac1 ~]# hostnamectl  set-hostname  oel7rac1  --pretty
[root@oel7rac1 ~]# hostnamectl  set-hostname  oel7rac1  --static
[root@oel7rac1 ~]# hostnamectl  set-hostname  oel7rac1  --transient
[root@oel7rac1 ~]# hostnamectl  status
```

```sql
[root@oel7rac1 ~]# grep MemTotal /proc/meminfo
   MemTotal:        7856532 kB

[root@oel7rac1 ~]# grep SwapTotal /proc/meminfo
 SwapTotal:      25698300 kB
```

```sql
[root@oel7rac1 ~]# vi /etc/security/limits.conf
grid       soft     nofile     4096
grid       hard     nofile     65536
grid       soft     nproc      16384
grid       hard     nproc      16384
grid       soft     stack      10240
grid       hard     stack      32768
grid       soft     memlock    3145728
grid       hard     memlock    3145728

oracle       soft     nofile     4096
oracle       hard     nofile     65536
oracle       soft     nproc      16384
oracle       hard     nproc      16384
oracle       soft     stack      10240
oracle       hard     stack      32768
oracle       soft     memlock    3145728
oracle       hard     memlock    3145728
```

```sql
[root@oel7rac1 ~]# systemctl stop firewalld
[root@oel7rac1 ~]# systemctl disable firewalld
```

```sql
[root@oel7rac1 ~]# yum install ntp
```

```sql
[root@oel7rac1 ~]# systemctl start ntpd
[root@oel7rac1 ~]# systemctl enable ntpd
[root@oel7rac1 ~]# systemctl status ntpd

[root@oel7rac1 ~]# shutdown -h 0 
```

### 2. create ASM : ì•ì„œ ë§Œë“  DISKì´ìš©í•´ì„œ ì„¸íŒ…

-ì´ ì‹œì ì— ì„œë²„ ë³µì‚¬-

![cloneì„ íƒ](2025-06-26_15_40_41.png)

cloneì„ íƒ

![2025-06-26 15 42 38.png](2025-06-26_15_42_38.png)

![2025-06-26 15 42 51.png](2025-06-26_15_42_51.png)

â‡’RAC2ì—ì„œëŠ” ì•„ê¹Œ ì§€ì •í•´ì¤€ IPì£¼ì†Œë¡œ ë°”ê¿”ì¤€ë‹¤(public, privateâ€¦)

```sql
[root@oel7rac1 ~]# hostnamectl  set-hostname  oel7rac2
 [root@oel7rac1 ~]# hostnamectl  set-hostname  oel7rac2  --pretty
 [root@oel7rac1 ~]# hostnamectl  set-hostname  oel7rac2  --static
 [root@oel7rac1 ~]# hostnamectl  set-hostname  oel7rac2  --transient
 hostnamectl  set-hostname  oel7rac2  --transient
 [root@oel7rac1 ~]# hostnamectl  status
```

```sql
* ê° ë…¸ë“œë³„ Reboot
[root@oel7rac1 ~]# reboot

[root@oel7rac1 ~]# reboot
```

```sql
[grid@oel7rac2 ~]$ ssh oel7rac2 => rac1 gridì—ì„œ í™•ì¸

[oracle@oel7rac2 ~]$ ssh oracle@oel7rac1 => rac2ì˜ oracleì—ì„œ í™•ì¸
```

```sql
asmlib ì„¤ì¹˜

[root@oel7rac1 ~]# yum list *oracleasm*

[root@oel7rac1 ~]# yum install oracleasm-support

[root@oel7rac1 ~]# yum install kmod-oracleasm

[root@oel7rac2 ~]# yum list *oracleasm*

[root@oel7rac2 ~]# yum install oracleasm-support

[root@oel7rac2 ~]# yum install kmod-oracleasm
```

```sql
- rac1/rac2
[root@oel7rac1 ~]# shutdown -h 0
[root@oel7rac2 ~]# shutdown -h 0
```

![rac1ì— í•˜ë“œë””ìŠ¤í¬ 20G ë¶™ì—¬ì£¼ê¸° (allocate), ê²½ë¡œëŠ” ì•„ê¹Œ Dë“œë¼ì´ë¸Œì— ë§Œë“  storage, ì´ë¦„ì€ asm01ë¶€í„° 03ê¹Œì§€ë§Œë“¤ê¸°](2025-06-26_16_11_35.png)

rac1ì— í•˜ë“œë””ìŠ¤í¬ 20G ë¶™ì—¬ì£¼ê¸° (allocate), ê²½ë¡œëŠ” ì•„ê¹Œ Dë“œë¼ì´ë¸Œì— ë§Œë“  storage, ì´ë¦„ì€ asm01ë¶€í„° 03ê¹Œì§€ë§Œë“¤ê¸°

![preallocatedì¸ ë””ìŠ¤í¬ë¥¼ ëˆ„ë¥´ê³  ì˜¤ë¥¸ìª½ ì¤‘ì•™ì˜ advanceí´ë¦­, independentëˆ„ë¥´ê³  persistentë¡œ ë³€í™˜](2025-06-26_16_12_40.png)

preallocatedì¸ ë””ìŠ¤í¬ë¥¼ ëˆ„ë¥´ê³  ì˜¤ë¥¸ìª½ ì¤‘ì•™ì˜ advanceí´ë¦­, independentëˆ„ë¥´ê³  persistentë¡œ ë³€í™˜

![ê¼­ persistentê°€ ëœ ê²ƒ í™•ì¸](2025-06-26_16_12_53.png)

ê¼­ persistentê°€ ëœ ê²ƒ í™•ì¸

![asm01, asm02, asm03 ë§Œë“¤ê¸°](2025-06-26_16_21_20.png)

asm01, asm02, asm03 ë§Œë“¤ê¸°

![rac2ì—ì„œ!!!! 1ì˜ ë””ìŠ¤í¬ë¥¼ ê°€ì ¸ì˜¨ë‹¤](2025-06-26_16_46_09.png)

rac2ì—ì„œ!!!! 1ì˜ ë””ìŠ¤í¬ë¥¼ ê°€ì ¸ì˜¨ë‹¤

![1ì—ì„œ ë§Œë“ ê²ƒ ì¬íƒ•í•˜ëŠ” 2](2025-06-26_16_46_22.png)

1ì—ì„œ ë§Œë“ ê²ƒ ì¬íƒ•í•˜ëŠ” 2

![ë°›ì€ìŠ¤í¬ë¦½íŠ¸.png](%EB%B0%9B%EC%9D%80%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8.png)

ë°›ì€ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ 

```sql
scsi0:1.deviceType = "disk"
```

```sql
scsi0:2.deviceType = "disk"
```

```sql
scsi0:3.deviceType = "disk"
```

```sql
disk.locking = "FALSE"
diskLib.dataCacheMaxSize = "0"
scsi0.sharedBus = "virtual"
```

ìœ„ ë‚´ìš©ì„  VMware virtual machine configurationíŒŒì¼ì— ì•„ë˜ í˜•íƒœì²˜ëŸ¼ ë³µë¶™í•´ì¤€ë‹¤(1,2ë‘˜ ë‹¤)

![2025-06-26 16 57 21.png](2025-06-26_16_57_21.png)

![ë¶™ì¸ê²°ê³¼ë¬¼](2025-06-26_16_56_25.png)

ë¶™ì¸ê²°ê³¼ë¬¼

<RAC1ì—ì„œ>

```sql
[root@oel7rac1 ~]# /usr/sbin/oracleasm configure -i
Configuring the Oracle ASM library driver.
```

```sql
[root@oel7rac1 ~]#  /usr/sbin/oracleasm init
```

```sql
[root@oel7rac1 ~]# fdisk -l
[root@oel7rac1 ~]# lsblk
[root@oel7rac1 ~]# fdisk /dev/sdb                           n-p-ì—”í„°-ì—”í„°-ì—”í„°-w
[root@oel7rac1 ~]# fdisk /dev/sdc                           n-p-ì—”í„°-ì—”í„°-ì—”í„°-w
[root@oel7rac1 ~]# fdisk /dev/sdd                           n-p-ì—”í„°-ì—”í„°-ì—”í„°-w
```

```sql
[root@oel7rac1 ~]# pvcreate /dev/sdb1 /dev/sdc1   /dev/sdd1   /dev/sde1   /dev/sdf1
```

![2025-06-26 17 17 55.png](2025-06-26_17_17_55.png)

```sql
[root@oel7rac1 ~]# oracleasm createdisk DATA1 /dev/sdb1
Writing disk header: done
Instantiating disk: done
[root@oel7rac1 ~]# oracleasm createdisk DATA2 /dev/sdc1
Writing disk header: done
Instantiating disk: done
[root@oel7rac1 ~]# oracleasm createdisk FRA   /dev/sdd1
Writing disk header: done
Instantiating disk: done
[root@oel7rac1 ~]# oracleasm listdisks
```

![2025-06-26 17 18 29.png](2025-06-26_17_18_29.png)

<RAC2ì—ì„œ>

```sql
[root@oel7rac1 ~]# /usr/sbin/oracleasm configure -i
```

```sql
[root@oel7rac1 ~]#  /usr/sbin/oracleasm init
```

```sql
[root@oel7rac2 ~]# oracleasm scandisks
```

![2025-06-26 17 18 51.png](2025-06-26_17_18_51.png)

<RAC1ê³¼ 2 ë‘˜ ë‹¤ gridì— ìŠ¤í¬ë¦½íŠ¸ ì‚½ì…>

```sql
$ cd /home/grid/.bash_profile
```

```sql
export LANG=C
export ORACLE_BASE=/u01/app/grid
export ORACLE_HOME=/u01/app/oracle/19.3.0/grid
export ORACLE_SID=+ASM1
export LD_LIBRARY_PATH=$ORACLE_HOME/lib:/lib:/usr/lib
export NLS_LANG=AMERICAN_AMERICA.AL32UTF8
export PATH=$ORACLE_HOME/bin:$PATH

alias oh='cd $ORACLE_HOME'
alias dbs='cd $ORACLE_HOME/dbs'
alias net='cd $ORACLE_HOME/network/admin'

```

<RAC1ì—ì„œ íŒŒì¼ ì••ì¶•í’€ê¸°>

```sql
[grid@oel7rac1 ~]$ cd /u01/app/oracle/19.3.0/grid
[grid@oel7rac1 grid]$ unzip -q /home/STAGE/V982068-01.zip
```

![[gridSetup.sh](http://gridsetup.sh/)  ìˆëŠ”ì§€ í™•ì¸](2025-06-26_18_04_52.png)

[gridSetup.sh](http://gridsetup.sh/)  ìˆëŠ”ì§€ í™•ì¸

```sql
[grid@oel7rac1 grid]$ ./gridSetup.sh
ERROR: Unable to verify the graphical display setup. This application requires X display. Make sure that xdpyinfo exist under PATH variable.

No X11 DISPLAY variable was set, but this program performed an operation which requires it.
[grid@oel7rac1 grid]$ export DISPLAY=192.168.101.1:0
[grid@oel7rac1 grid]$ ./gridSetup.sh
Launching Oracle Grid Infrastructure Setup Wizard...
```

6ì›”26ì¼ ì—¬ê¸°ê¹Œì§€ 6ì›”27ì¼ì— [grid@oel7rac1 grid]$ ./gridSetup.shë¶€í„° ë‹¤ì‹œ
